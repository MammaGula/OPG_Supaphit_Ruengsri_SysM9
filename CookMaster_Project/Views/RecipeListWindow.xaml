<Window x:Class="CookMaster_Project.Views.RecipeListWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Recipe List" Height="400" Width="1100">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- New StackPanel for User and Sign Out -->
            <RowDefinition Height="Auto"/>
            <!-- Toolbar -->
            <RowDefinition Height="*"/>
            <!-- Recipe List -->
            <RowDefinition Height="Auto"/>
            <!-- Bottom Buttons -->
        </Grid.RowDefinitions>

        <!-- New StackPanel for User and Sign Out -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right" Margin="10">
            <TextBlock Text="{Binding LoggedInUsername}" FontSize="16" Margin="0,0,10,0"/>
            <Button Content="User" Command="{Binding OpenUserDetailsCommand}" Margin="5,0"/>
            <Button Content="Sign Out" Command="{Binding SignOutCommand}" Margin="5,0"/>
        </StackPanel>

        <!-- Toolbar: Left=Search/Filter -->
        <Grid Grid.Row="1" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,8,0">
                <TextBlock Text="Search:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBox Width="140"
                         Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}"
                         Margin="0,0,8,0"/>

                <TextBlock Text="Type:" VerticalAlignment="Center" Margin="12,0,0,0"/>
                <ComboBox Width="130"
                          ItemsSource="{Binding Filters}"
                          SelectedItem="{Binding SelectedFilter}"
                          Margin="0,0,12,0"/>

                <!-- Date range filters -->
                <TextBlock Text="From:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                <DatePicker SelectedDate="{Binding FromDate}" Width="130" Margin="0,0,8,0"/>
                <TextBlock Text="To:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                <DatePicker SelectedDate="{Binding ToDate}" Width="130" Margin="0,0,12,0"/>

                <!-- Sorting -->
                <TextBlock Text="Sort:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                <ComboBox Width="130"
                          ItemsSource="{Binding SortOptions}"
                          SelectedItem="{Binding SortBy}"
                          Margin="0,0,6,0"/>
                <CheckBox Content="Desc" IsChecked="{Binding SortDescending}" VerticalAlignment="Center" Margin="0,0,12,0"/>

                <!-- Favorites filter -->
                <CheckBox Content="Only favorites"
                          IsChecked="{Binding ShowOnlyFavorites}"
                          VerticalAlignment="Center"/>
            </StackPanel>
        </Grid>

        <!-- Recipe List -->
        <ListView Grid.Row="2" ItemsSource="{Binding FilteredRecipes}" SelectedItem="{Binding SelectedRecipe}" Margin="15">
            <ListView.View>
                <GridView>
                    <!-- Favorite toggle -->
                    <GridViewColumn Header="Fav" Width="100">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <CheckBox IsChecked="{Binding IsFavorite, Mode=TwoWay}" HorizontalAlignment="Center"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn Header="Title" DisplayMemberBinding="{Binding Title}" Width="350"/>
                    <GridViewColumn Header="Type" DisplayMemberBinding="{Binding Type}" Width="200"/>
                    <GridViewColumn Header="Created" DisplayMemberBinding="{Binding CreatedDate}" Width="220"/>
                    <GridViewColumn Header="By" DisplayMemberBinding="{Binding CreatedBy}" Width="200"/>
                </GridView>
            </ListView.View>
        </ListView>

        <!-- Bottom Buttons -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Center" Margin="10">
            <Button Content="Add Recipe" Command="{Binding AddRecipeCommand}" Margin="5,0"/>
            <Button Content="Remove Recipe" Command="{Binding RemoveRecipeCommand}" Margin="5,0"/>
            <Button Content="Details" Command="{Binding ViewDetailsCommand}" Margin="5,0"/>
            <Button Content="AppInfo" Command="{Binding ShowInfoCommand}" Margin="5,0"/>
        </StackPanel>
    </Grid>
</Window>
